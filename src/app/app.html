<!-- Enhanced Navigation Header -->
<mat-toolbar color="primary" class="app-toolbar">
  <div class="toolbar-content">
    <!-- Brand -->
    <div class="brand" routerLink="/dashboard">
      <mat-icon>home_work</mat-icon>
      <span>Vibe Property Manager</span>
    </div>
    
    <!-- Main Navigation -->
    <nav class="nav-links">
      <a mat-button routerLink="/dashboard" routerLinkActive="active-link" matTooltip="Dashboard">
        <mat-icon>dashboard</mat-icon>
        <span class="nav-label">Dashboard</span>
      </a>
      
      <!-- Properties Menu -->
      <button mat-button [matMenuTriggerFor]="propertiesMenu" 
              [class.active-link]="router.url.includes('/properties')"
              matTooltip="Properties Management">
        <mat-icon matBadge="{{ propertiesCount() }}" matBadgeColor="accent" matBadgeSize="small">apartment</mat-icon>
        <span class="nav-label">Properties</span>
        <mat-icon class="dropdown-icon">arrow_drop_down</mat-icon>
      </button>
      <mat-menu #propertiesMenu="matMenu" class="enhanced-menu">
        <div class="menu-header">
          <mat-icon>apartment</mat-icon>
          <span>Property Management</span>
        </div>
        <mat-divider></mat-divider>
        
        <!-- Quick Actions -->
        <button mat-menu-item (click)="navigateToAddProperty()">
          <mat-icon>add_circle</mat-icon>
          <span>Add New Property</span>
        </button>
        <button mat-menu-item routerLink="/properties">
          <mat-icon>list</mat-icon>
          <span>View All Properties ({{ propertiesCount() }})</span>
        </button>
        <mat-divider></mat-divider>
        
        <!-- Recent Properties -->
        <div class="menu-section-header">Recent Properties</div>
        @for (property of propertyService.properties().slice(0, 5); track property.id) {
          <button mat-menu-item (click)="navigateToProperty(property.id)" class="property-menu-item">
            <div class="property-item">
              <div class="property-info">
                <span class="property-name">{{ property.name }}</span>
                <span class="property-address">{{ property.address }}</span>
              </div>
              <div class="property-status" [class.active]="property.isActive" [class.inactive]="!property.isActive">
                {{ property.isActive ? 'Active' : 'Inactive' }}
              </div>
            </div>
          </button>
        } @empty {
          <div class="empty-menu-item">No properties yet</div>
        }
      </mat-menu>
      
      <!-- Financial Menu -->
      <button mat-button [matMenuTriggerFor]="financialMenu" 
              [class.active-link]="router.url.includes('/revenue') || router.url.includes('/expenses') || router.url.includes('/invoices')"
              matTooltip="Financial Management">
        <mat-icon>account_balance</mat-icon>
        <span class="nav-label">Financial</span>
        <mat-icon class="dropdown-icon">arrow_drop_down</mat-icon>
      </button>
      <mat-menu #financialMenu="matMenu" class="enhanced-menu">
        <div class="menu-header">
          <mat-icon>account_balance</mat-icon>
          <span>Financial Management</span>
        </div>
        <mat-divider></mat-divider>
        
        <!-- Invoices Section -->
        <div class="menu-section-header">Invoices</div>
        <button mat-menu-item (click)="navigateToAddInvoice()">
          <mat-icon>add_circle</mat-icon>
          <span>Create Invoice</span>
        </button>
        <button mat-menu-item (click)="navigateToInvoices()">
          <mat-icon matBadge="{{ pendingInvoicesCount() }}" matBadgeColor="warn" 
                   [matBadgeHidden]="pendingInvoicesCount() === 0">receipt</mat-icon>
          <span>View All Invoices ({{ invoicesCount() }})</span>
        </button>
        
        <mat-divider></mat-divider>
        
        <!-- Revenue Section -->
        <div class="menu-section-header">Revenue</div>
        <button mat-menu-item (click)="navigateToAddRevenue()">
          <mat-icon>add_circle</mat-icon>
          <span>Record Revenue</span>
        </button>
        <button mat-menu-item disabled>
          <mat-icon>trending_up</mat-icon>
          <span>Total Entries: {{ revenuesCount() }}</span>
        </button>
        
        <mat-divider></mat-divider>
        
        <!-- Expenses Section -->
        <div class="menu-section-header">Expenses</div>
        <button mat-menu-item (click)="navigateToAddExpense()">
          <mat-icon>add_circle</mat-icon>
          <span>Add Expense</span>
        </button>
        <button mat-menu-item disabled>
          <mat-icon>trending_down</mat-icon>
          <span>Total Entries: {{ expensesCount() }}</span>
        </button>
        
        @if (propertiesCount() > 0) {
          <mat-divider></mat-divider>
          <div class="menu-section-header">Quick Add by Property</div>
          @for (property of propertyService.properties().slice(0, 3); track property.id) {
            <button mat-menu-item [matMenuTriggerFor]="propertyFinancialSubmenu" 
                    class="property-submenu-trigger"
                    (click)="selectedPropertyId = property.id">
              <mat-icon>home</mat-icon>
              <span>{{ property.name }}</span>
              <mat-icon class="submenu-arrow">chevron_right</mat-icon>
            </button>
          }
        }
      </mat-menu>
      
      <!-- Property Financial Submenu -->
      <mat-menu #propertyFinancialSubmenu="matMenu" class="submenu">
        <button mat-menu-item (click)="navigateToPropertyRevenue(selectedPropertyId!)">
          <mat-icon>payment</mat-icon>
          <span>Add Revenue</span>
        </button>
        <button mat-menu-item (click)="navigateToPropertyExpense(selectedPropertyId!)">
          <mat-icon>receipt</mat-icon>
          <span>Add Expense</span>
        </button>
        <button mat-menu-item (click)="navigateToProperty(selectedPropertyId!)">
          <mat-icon>visibility</mat-icon>
          <span>View Property</span>
        </button>
        <button mat-menu-item (click)="navigateToPropertyEdit(selectedPropertyId!)">
          <mat-icon>edit</mat-icon>
          <span>Edit Property</span>
        </button>
      </mat-menu>
      
      <!-- Map View -->
      <a mat-button routerLink="/map" routerLinkActive="active-link" matTooltip="Property Map View">
        <mat-icon>map</mat-icon>
        <span class="nav-label">Map</span>
      </a>
      
      <!-- Invoices -->
      <a mat-button routerLink="/invoices" routerLinkActive="active-link" matTooltip="Invoice Management">
        <mat-icon matBadge="{{ pendingInvoicesCount() }}" matBadgeColor="warn" 
                 [matBadgeHidden]="pendingInvoicesCount() === 0">receipt_long</mat-icon>
        <span class="nav-label">Invoices</span>
      </a>
      
      <!-- Reports -->
      <a mat-button routerLink="/reports" routerLinkActive="active-link" matTooltip="Reports & Analytics">
        <mat-icon>assessment</mat-icon>
        <span class="nav-label">Reports</span>
      </a>
    </nav>

    <!-- Quick Action Buttons -->
    <div class="quick-actions">
      <button mat-mini-fab color="accent" (click)="navigateToAddProperty()" 
              matTooltip="Quick Add Property" class="quick-fab">
        <mat-icon>add_home</mat-icon>
      </button>
      
      <button mat-icon-button [matMenuTriggerFor]="quickMenu" 
              matTooltip="Quick Actions" class="quick-menu-trigger">
        <mat-icon>more_vert</mat-icon>
      </button>
      <mat-menu #quickMenu="matMenu">
        <div class="menu-header">
          <mat-icon>flash_on</mat-icon>
          <span>Quick Actions</span>
        </div>
        <mat-divider></mat-divider>
        
        <button mat-menu-item (click)="navigateToAddRevenue()">
          <mat-icon>payment</mat-icon>
          <span>Record Revenue</span>
        </button>
        <button mat-menu-item (click)="navigateToAddExpense()">
          <mat-icon>receipt</mat-icon>
          <span>Add Expense</span>
        </button>
        <button mat-menu-item routerLink="/reports">
          <mat-icon>assessment</mat-icon>
          <span>View Reports</span>
        </button>
        <mat-divider></mat-divider>
        <button mat-menu-item (click)="loadSampleData()">
          <mat-icon>upload</mat-icon>
          <span>Load Sample Data</span>
        </button>
        <button mat-menu-item (click)="exportData()">
          <mat-icon>download</mat-icon>
          <span>Export Data</span>
        </button>
        <button mat-menu-item (click)="clearData()">
          <mat-icon>clear_all</mat-icon>
          <span>Clear All Data</span>
        </button>
      </mat-menu>
    </div>
  </div>
</mat-toolbar>

<!-- Main Content -->
<main class="app-content">
  <router-outlet />
</main>
